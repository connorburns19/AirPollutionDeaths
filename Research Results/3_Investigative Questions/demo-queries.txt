-------------------- Loading schema and data and relations and queries: --------------------
csc343h-burnsco2=> \i schema.ddl

--Create schema, create table, drop table output follows, not including since not tidy--

csc343h-burnsco2=> \i queries.sql
--Exluding drop views if exists; not tidy--
CREATE VIEW
CREATE VIEW
CREATE VIEW
CREATE VIEW
CREATE VIEW
CREATE VIEW
CREATE VIEW
CREATE VIEW
CREATE VIEW
CREATE VIEW
CREATE VIEW
CREATE VIEW
CREATE VIEW
CREATE VIEW

-------------------- Investigative Question 1: ------------------
WorldDeathsAndEmissions

csc343h-burnsco2=> SELECT * FROM IQ1_WorldDeathsAndEmissions;
 location | year | totaldeathsper100k |   tonnes    
----------+------+--------------------+-------------
 World    | 1990 |   111.276364439682 | 22181807367
 World    | 1991 |   110.072197219961 | 22429377426
 World    | 1992 |   108.892268641147 | 22195105131
 World    | 1993 |   107.759021594377 | 22153143108
 World    | 1994 |   106.142782640316 | 22533832969
 World    | 1995 |   103.909811104855 | 23007425377
 World    | 1996 |   102.003433399156 | 23522979106
 World    | 1997 |   100.554898708802 | 23915329404
 World    | 1998 |   98.6086343797261 | 23984983896
 World    | 1999 |   95.9729947855769 | 23930561468
 World    | 2000 |   93.7018855478395 | 24558691083
 World    | 2001 |   91.7177861689108 | 25137999688
 World    | 2002 |   90.1660780141522 | 25494190555
 World    | 2003 |   88.4720070199722 | 26866738381
 World    | 2004 |   85.5224198413889 | 28187598935
 World    | 2005 |   83.0897487454679 | 29254906351
 World    | 2006 |   80.4226259235425 | 30286836386
 World    | 2007 |   78.5316871283445 | 30880145296
 World    | 2008 |   77.2926824726339 | 31875755797
 World    | 2009 |   76.0145386431221 | 31523142973
 World    | 2010 |   74.8577893692964 | 33066651212
 World    | 2011 |    73.599294713277 | 34357365920
 World    | 2012 |   71.0943859270424 | 34919288710
 World    | 2013 |   69.1305403084385 | 35207885978
 World    | 2014 |   67.3842042658963 | 35505827039
 World    | 2015 |   67.0815026475787 | 35462746737
 World    | 2016 |    65.150784602843 | 35675099439
 World    | 2017 |   63.8229655963607 | 36153261645
(28 rows)

WorldConsecutiveDeathsAndEmissions

csc343h-burnsco2=> SELECT * FROM IQ1_WorldConsecutiveDeathsAndEmissions;
 location | year1 | year2 | deathspercentchange | emissionspercentchange 
----------+-------+-------+---------------------+------------------------
 World    |  1990 |  1991 |   -1.08214105105332 |        1.1160950724345
 World    |  1991 |  1992 |   -1.07195877670718 |      -1.04448862110828
 World    |  1992 |  1993 |   -1.04070478180979 |     -0.189059807341897
 World    |  1993 |  1994 |   -1.49986416928051 |       1.71844626807166
 World    |  1994 |  1995 |   -2.10374316549379 |         2.101694854362
 World    |  1995 |  1996 |   -1.83464649336674 |       2.24081452206029
 World    |  1996 |  1997 |   -1.42008424822857 |       1.66794476257441
 World    |  1997 |  1998 |   -1.93552413066669 |      0.291254579116731
 World    |  1998 |  1999 |   -2.67282840973111 |     -0.226902082719664
 World    |  1999 |  2000 |   -2.36640446910258 |       2.62480099282224
 World    |  2000 |  2001 |   -2.11745939511075 |       2.35887410710178
 World    |  2001 |  2002 |   -1.69182905472759 |       1.41694196603094
 World    |  2002 |  2003 |   -1.87883407096198 |       5.38376703131221
 World    |  2003 |  2004 |   -3.33392140399552 |       4.91634129632239
 World    |  2004 |  2005 |   -2.84448347045453 |       3.78644317474925
 World    |  2005 |  2006 |   -3.20993006019992 |        3.5273742551725
 World    |  2006 |  2007 |   -2.35125224211871 |       1.95896627313064
 World    |  2007 |  2008 |   -1.57771302389778 |       3.22411210004561
 World    |  2008 |  2009 |   -1.65364144266096 |        -1.106210080933
 World    |  2009 |  2010 |   -1.52174741105312 |       4.89642876131367
 World    |  2010 |  2011 |     -1.681180631465 |       3.90337291709659
 World    |  2011 |  2012 |   -3.40344129110616 |       1.63552348951436
 World    |  2012 |  2013 |   -2.76230759010875 |      0.826469491966923
 World    |  2013 |  2014 |   -2.52614262054158 |      0.846233884039989
 World    |  2014 |  2015 |  -0.449217471090389 |     -0.121333047538028
 World    |  2015 |  2016 |    -2.8781675551888 |      0.598805003952055
 World    |  2016 |  2017 |   -2.03807063042548 |       1.34032480222683
(27 rows)

Percent_DeathsEmissions_ConsecutiveYears_Increase

csc343h-burnsco2=> SELECT * FROM IQ1_Percent_DeathsEmissions_ConsecutiveYears_Increase;
 percentage 
------------
          0
(1 row)


-------------------- Investigative Question 1 Follow Up Questions: ------------------
AllConsecutiveDeaths 

csc343h-burnsco2=> SELECT * FROM IQ1_followup_AllConsecutiveDeaths;
     entity      | year1 | year2 | deathspercentchange 
-----------------+-------+-------+---------------------
 Brazil          |  1990 |  1991 |   -4.59282286228397
 Brazil          |  1991 |  1992 |   -2.16582548653821
 Brazil          |  1992 |  1993 |  -0.899598297825958
 Brazil          |  1993 |  1994 |   -3.75021242601814
 Brazil          |  1994 |  1995 |    -4.7901242895868
 Brazil          |  1995 |  1996 |   -4.51784032431257
 Brazil          |  1996 |  1997 |   -4.99637958708509
 Brazil          |  1997 |  1998 |     -3.188258282471
 Brazil          |  1998 |  1999 |   -4.03726698369563
 Brazil          |  1999 |  2000 |   -4.77643347334554
 Brazil          |  2000 |  2001 |   -3.00507029371334
 Brazil          |  2001 |  2002 |   -2.87069513926322
 Brazil          |  2002 |  2003 |   -2.49122631140735
 Brazil          |  2003 |  2004 |   -3.47352494028238
 Brazil          |  2004 |  2005 |   -6.03392640090356
 Canada          |  1990 |  1991 |   -1.71835092037101
 Canada          |  1991 |  1992 |    -1.4176819588761
 Canada          |  1992 |  1993 |   0.101972967999429
 Canada          |  1993 |  1994 |   -1.86714498002544
 Canada          |  1994 |  1995 |   -1.22648252339545
 Canada          |  1995 |  1996 |  -0.647874867132224
 Canada          |  1996 |  1997 |   -1.14210500408141
 Canada          |  1997 |  1998 |   -1.24183601656193
 Canada          |  1998 |  1999 |   -2.20889396644544
 Canada          |  1999 |  2000 |   -4.30735313574214
 Canada          |  2000 |  2001 |   -2.17299896505345
 Canada          |  2001 |  2002 |   -1.51442626575725
 Canada          |  2002 |  2003 |   -1.81288001029923
 Canada          |  2003 |  2004 |   -3.97037906331063
 Canada          |  2004 |  2005 |   -3.34896065737875
 High SDI        |  1990 |  1991 |   -1.81097082421314
 High SDI        |  1991 |  1992 |   -3.00891366514052
 High SDI        |  1992 |  1993 |   -1.46926252211362
 High-middle SDI |  1990 |  1991 |    -0.6788951967019
 High-middle SDI |  1991 |  1992 |  -0.144345622331341
 High-middle SDI |  1992 |  1993 |    1.18108151358374
 Low SDI         |  1990 |  1991 |    -1.4964192791879
 Low SDI         |  1991 |  1992 |  -0.729826530283735
 Low SDI         |  1992 |  1993 |   -1.74977165516421
 Low-middle SDI  |  1990 |  1991 |  -0.600586061600378
 Low-middle SDI  |  1991 |  1992 |  -0.955824590563421
 Low-middle SDI  |  1992 |  1993 |   -1.94792591277459
 Middle SDI      |  1990 |  1991 |   -1.82773900743746
 Middle SDI      |  1991 |  1992 |   -1.95075238670258
 Middle SDI      |  1992 |  1993 |    -2.3351301237901
 World           |  1990 |  1991 |   -1.08214105105332
 World           |  1991 |  1992 |   -1.07195877670718
 World           |  1992 |  1993 |   -1.04070478180979
 World           |  1993 |  1994 |   -1.49986416928051
 World           |  1994 |  1995 |   -2.10374316549379
 World           |  1995 |  1996 |   -1.83464649336674
 World           |  1996 |  1997 |   -1.42008424822857
 World           |  1997 |  1998 |   -1.93552413066669
 World           |  1998 |  1999 |   -2.67282840973111
 World           |  1999 |  2000 |   -2.36640446910258
 World           |  2000 |  2001 |   -2.11745939511075
 World           |  2001 |  2002 |   -1.69182905472759
 World           |  2002 |  2003 |   -1.87883407096198
 World           |  2003 |  2004 |   -3.33392140399552
 World           |  2004 |  2005 |   -2.84448347045453
 World           |  2005 |  2006 |   -3.20993006019992
 World           |  2006 |  2007 |   -2.35125224211871
 World           |  2007 |  2008 |   -1.57771302389778
 World           |  2008 |  2009 |   -1.65364144266096
 World           |  2009 |  2010 |   -1.52174741105312
 World           |  2010 |  2011 |     -1.681180631465
 World           |  2011 |  2012 |   -3.40344129110616
 World           |  2012 |  2013 |   -2.76230759010875
 World           |  2013 |  2014 |   -2.52614262054158
 World           |  2014 |  2015 |  -0.449217471090389
 World           |  2015 |  2016 |    -2.8781675551888
 World           |  2016 |  2017 |   -2.03807063042548
(72 rows)

WorldAllDeathsActualAmount

csc343h-burnsco2=> SELECT * FROM IQ1_followup_AllDeathsActualAmount;
 location | year |   totaldeaths    | totaldeathspercentageofpopulation | totaloutdoordeaths | totalindoordeaths | totalozonedeaths 
----------+------+------------------+-----------------------------------+--------------------+-------------------+------------------
 World    | 1990 | 5927948.98210372 |                  1.11276364439682 |   3255689.96914688 |  2326849.35777153 |  579660.64695817
 World    | 1991 | 5959626.86613864 |                  1.10072197219961 |   3221487.82230192 |   2386017.3052345 | 587738.733877933
 World    | 1992 | 5987898.73876175 |                  1.08892268641147 |   3190162.61425902 |  2440776.33132334 | 592660.427748328
 World    | 1993 | 6014675.39413133 |                  1.07759021594377 |   3139791.71221056 |  2513478.24535101 | 595958.602851028
 World    | 1994 | 6011024.99509505 |                  1.06142782640316 |   3090730.29791136 |  2555970.62432208 | 597497.772994378
 World    | 1995 | 5968800.87776055 |                  1.03909811104855 |   3035099.77585559 |  2569019.08224892 | 594324.081031089
 World    | 1996 | 5941589.83179278 |                  1.02003433399156 |   2977616.94424889 |  2599119.51997927 | 592069.729420244
 World    | 1997 | 5937813.02400819 |                  1.00554898708802 |   2945589.52649725 |  2626271.32816975 | 592378.161241564
 World    | 1998 | 5901523.63383979 |                 0.986086343797261 |   2891668.01063618 |  2643737.85263326 | 590482.723986861
 World    | 1999 | 5820031.77925492 |                 0.959729947855769 |   2801880.20084036 |  2658680.51230541 | 576068.939413026
 World    | 2000 | 5756569.71651838 |                 0.937018855478395 |   2737737.99212883 |  2664715.90454556 | 564919.981515186
 World    | 2001 | 5707255.72594891 |                 0.917177861689108 |   2662523.69166723 |  2697126.02631962 |  553002.37134685
 World    | 2002 | 5682061.55945478 |                 0.901660780141523 |   2596471.21880833 |   2742207.7773091 | 544884.904769564
 World    | 2003 | 5645562.44115741 |                 0.884720070199722 |   2525447.00049304 |  2780817.93060254 | 536570.819834665
 World    | 2004 | 5525739.52659969 |                 0.855224198413889 |   2431151.09206494 |  2766017.26203455 | 517885.195913701
 World    | 2005 | 5435654.08946218 |                 0.830897487454679 |   2349485.13752768 |  2766674.57915273 | 501195.726934829
 World    | 2006 |  5326807.1041185 |                 0.804226259235425 |   2261695.10576662 |  2757290.94853775 | 482040.985967002
 World    | 2007 |  5266293.3170326 |                 0.785316871283445 |   2188622.18625311 |  2775590.06794357 |    472056.459657
 World    | 2008 | 5247469.00355452 |                 0.772926824726339 |   2126457.92297606 |  2820119.19429435 | 468918.992364774
 World    | 2009 | 5224302.12706674 |                 0.760145386431221 |    2069944.3457885 |  2853210.79935584 | 468113.021695097
 World    | 2010 | 5207724.65671266 |                 0.748577893692964 |   2017499.87916811 |  2888578.85602468 | 467577.934240302
 World    | 2011 | 5182269.12339357 |                  0.73599294713277 |   1954505.22337524 |  2928424.05197533 |  463020.77428114
 World    | 2012 | 5066063.65881725 |                 0.710943859270424 |   1919906.93992909 |  2847417.76947304 | 456384.754448715
 World    | 2013 | 4984714.29598301 |                 0.691305403084385 |    1839299.1987058 |   2850599.8894733 | 449126.039476127
 World    | 2014 | 4915873.78923155 |                 0.673842042658963 |   1787885.38476252 |   2828655.6399547 | 451548.560895513
 World    | 2015 | 4950478.71994093 |                 0.670815026475787 |   1730696.78615746 |  2914575.44815737 | 458604.140717259
 World    | 2016 | 4862868.89592881 |                  0.65150784602843 |   1699036.62770667 |  2851532.63395265 | 464049.013401606
 World    | 2017 | 4817267.45283181 |                 0.638229655963607 |   1620226.52934494 |  2879837.04665807 | 469950.471581692
(28 rows)

CumulativeWorldDeaths1990to2017

csc343h-burnsco2=> SELECt * FROM IQ1_followup_AllDeaths1990to2017;
 alldeaths1990to2017 | outdoordeaths1990to2017 | indoordeaths1990to2017 | ozonedeaths1990to2017 
---------------------+-------------------------+------------------------+-----------------------
     154275909.32664 |        69068309.1365322 |       75933311.9851038 |      14688689.9685636
(1 row)


-------------------- Investigative Question 2: ------------------
AverageDeathsBySDI

csc343h-burnsco2=> SELECT * FROM IQ2_AverageDeathsBySDI;
     sdirank     | avgtotaldeathsper100k | avgoutdoordeathsper100k | avgindoordeathsper100k | avgozonedeathsper100k 
-----------------+-----------------------+-------------------------+------------------------+-----------------------
 Low SDI         |           214.7501039 |           156.393866625 |          48.5161417825 |          20.204663995
 Low-middle SDI  |         169.435750275 |            118.20945225 |           43.138176315 |           14.83752543
 Middle SDI      |         131.371608675 |           78.1380202025 |           43.632525035 |         16.4860246875
 High-middle SDI |           105.7853275 |            39.745548565 |           57.163876925 |         14.2934256125
 High SDI        |         35.7425763325 |           2.57762475175 |          30.7485491825 |         3.00212744925
(5 rows)


-------------------- Investigative Question 2 Follow Up Questions: ------------------
ConsecutiveSDIsAverageDeathsChange

csc343h-burnsco2=> SELECT * FROM IQ2_followup_SDI_Deaths_Percent_Change;
 low_to_lowmiddle_sdi_percent_change | lowmiddle_to_middle_sdi_percent_change | middle_to_middlehigh_sdi_percent_change | middlehigh_to_high_sdi_percent_change 
-------------------------------------+----------------------------------------+-----------------------------------------+---------------------------------------
                   -21.1009693602295 |                      -22.4652362551708 |                       -19.4762638846098 |                     -66.2121608192781
(1 row)


-------------------- Investigative Question 3: ------------------
ConsecutivePopulationAndEmissions

csc343h-burnsco2=> SELECT * FROM IQ3_ConsecutivePopulatioAndEmissions;
 location | year1 | year2 | populationpercentchange | emissionspercentchange 
----------+-------+-------+-------------------------+------------------------
 Canada   |  1985 |  1986 |        1.28568654107594 |      -4.03520529076289
 Canada   |  1986 |  1987 |        1.36907501150483 |       6.48979304783037
 Canada   |  1987 |  1988 |        1.41111489426096 |       5.72872058773206
 Canada   |  1988 |  1989 |        1.39147951951056 |       1.58243298465854
 Canada   |  1989 |  1990 |        1.33191066632326 |      0.229479546069073
 Canada   |  1990 |  1991 |        1.26357067644603 |      -1.99454399296813
 Canada   |  1991 |  1992 |        1.20119043350425 |       3.13163263737267
 Canada   |  1992 |  1993 |        1.14795918367347 |     -0.210122911400036
 Canada   |  1993 |  1994 |        1.09639904721872 |       3.24418557777642
 Canada   |  1994 |  1995 |        1.04985967222203 |       2.60963420056833
 Canada   |  1995 |  1996 |        1.00809216842683 |       3.00450613899059
 Canada   |  1996 |  1997 |        0.96408445923009 |       2.87848200072423
 Canada   |  1997 |  1998 |       0.941429628135297 |       1.71030430581493
 Canada   |  1998 |  1999 |       0.935980281127173 |       2.95873695900008
 Canada   |  1999 |  2000 |        0.94050094050094 |        4.0883319411983
 Canada   |  2000 |  2001 |       0.954622727867138 |        -1.379038599744
 Canada   |  2001 |  2002 |       0.965025906735751 |       1.10686977550272
 Canada   |  2002 |  2003 |       0.994290846109436 |       2.92724276117898
 Canada   |  2003 |  2004 |        1.03849085365854 |     -0.300119525686496
 Canada   |  2004 |  2005 |         1.0969668395411 |       -1.5415952488135
 Brazil   |  1985 |  1986 |        2.09574641098807 |       9.60860333923215
 Brazil   |  1986 |  1987 |        2.01507504941749 |       4.34147377863995
 Brazil   |  1987 |  1988 |        1.94191295460353 |      0.862158923858253
 Brazil   |  1988 |  1989 |        1.87985629542986 |       2.19243160406616
 Brazil   |  1989 |  1990 |        1.82808485047291 |      -2.44799137359781
 Brazil   |  1990 |  1991 |        1.77513204432126 |       4.98081201184297
 Brazil   |  1991 |  1992 |        1.72175036927622 |      0.532175782996729
 Brazil   |  1992 |  1993 |        1.67899441847801 |       4.55607306310096
 Brazil   |  1993 |  1994 |        1.64744435731181 |       4.87774148462044
 Brazil   |  1994 |  1995 |        1.62262517797445 |       6.72844513099556
 Brazil   |  1995 |  1996 |        1.60165411677571 |       10.0207644177922
 Brazil   |  1996 |  1997 |        1.57579807429457 |       5.47324234862052
 Brazil   |  1997 |  1998 |        1.54058693012936 |       3.95180264793743
 Brazil   |  1998 |  1999 |        1.49247577819006 |       2.58727603237462
 Brazil   |  1999 |  2000 |        1.43396839582402 |       2.51155264895516
 Brazil   |  2000 |  2001 |        1.37650895360146 |       2.70223822861359
 Brazil   |  2001 |  2002 |        1.32170026411431 |      -1.66750093246772
 Brazil   |  2002 |  2003 |        1.26491327741202 |      -3.03156018538675
 Brazil   |  2003 |  2004 |        1.20841102475675 |       5.09173727560156
 Brazil   |  2004 |  2005 |        1.15267980391944 |       2.52081347719445
(40 rows)

Percent_PopulationEmissions_ConsecutiveYears_Increase

csc343h-burnsco2=> SELECt * FROM IQ3_Percent_PopulationEmissions_ConsecutiveYears_Increase;
 percentage 
------------
       77.5
(1 row)


-------------------- Investigative Question 3 Follow Up Questions: ------------------
AverageTonnesPerCapita

csc343h-burnsco2=> SELECT * FROM IQ3_followup_AvgTonnesPerCapita;
 location | avgtonnespercapita 
----------+--------------------
 Brazil   |   1.63449211770698
 Canada   |   17.3544660931579
(2 rows)

